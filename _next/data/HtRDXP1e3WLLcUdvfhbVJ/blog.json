{"pageProps":{"allPosts":[{"title":"Playing Around with GCP Virtual Machine #1 - Study Log","excerpt":"Study log of me playing around with GCP Virtual Machine","date":"2023-07-26","slug":"playing-around-with-gcp-virtual-machine-1-study-log","content":"\nSo, to build a solution implementation for my industrial internship (Kerja Praktik/KP) course, we decided to create our own development environment as we don't have any access to the company's source code (yet) and the database access we have only have read-only access. I decided to use this opportunity to play around and use GCP Virtual Machine as I have some free credits from trying the free trial and got some more by using organization email. I also used Database Instance using Cloud SQL, for us to do the actual work while I tinker around with the virtual machine.\n\n# First Steps\n\nAfter redeeming my Free Trial I got about $300 credits and $100 from Organization Free Trial Bonus.\n\nOn the welcome page, you can see quick access to the most used services, and also some recommended services. I decided to use Compute Engine as I want to create a virtual machine.\n\n## Creating the Virtual Machine\n\nActually I'm not really new with cloud stuffs, as I have experience deploying apps using other platforms like Azure Static Web Apps, Heroku, Netlify, Vercel, and Render, mostly Platform as a Service (PaaS) solutions. But, I never really tried to use a virtual machine before, which is Infrastructure as a Service (SaaS). So, I decided to try it out. It seems interesting that I can have a full control of the machine, I can install anything I want, and it's really cheaper than PaaS solutions.\n\nAs it's just a dummy machine for development, I decided to use the cheapest machine type, `e2-micro` and choose the zone `asia-southeast2-a` as it's the closest zone to my location. I also choose the Debian 11 Bullseye as the OS.\n\n## Connecting to the Virtual Machine\n\nAfter creating the machine, I can see the machine's details, and also the SSH button to connect to the machine via their in-browser terminal. I can also see the machine's public IP address, which I can use to connect to the machine using SSH from my local machine. But it requires me to add my local machine's SSH key to the SSH Keys section in the machine's details page.\n\nThe steps was pretty straightforward, as I have generated my SSH key before using `id_ed25519` when I was using Git. I also have the `id_rsa` one, but for this, I choose `id_ed25519`. I just need to copy the public key from `~/.ssh/id_ed25519.pub` and paste it to the SSH Keys section. If you don't have any SSH key, you can generate one using `ssh-keygen` command.\n\nAfter that, I can connect to the machine using SSH from my local machine.\n\n```sh\nssh -i ~/.ssh/id_ed25519 <username>@<ip-address>\n```\n\nAnd now we're in the machine! I can do anything I want.\n\n## Create a server\n\nTo test the machine, I decided to create a simple server using `apache2`. So I installed `apache2`, and enable the service. I also need to open the port 80 to allow HTTP traffic.\n\n```sh\nsudo apt install apache2\nsudo systemctl enable apache2\nsudo ufw allow 80\n```\n\nAnd now I can access the server in the browser using the machine's public IP address. It's still the default page, but it's working.\n\n---\n\nThat's it for now, I'll continue this later. I plan to install some more things like Node, Nginx, MySQL, and Docker to prepare the environment needed for our implementation. Actually we can just implement the solution without deploying it to the virtual machine, but I want to use this opportunity to learn more about cloud stuffs, and also to have a better understanding of what is actually going on when we deploy our apps to the cloud."},{"title":"Hello, world!","excerpt":"Hello, world! This is my first post on my built-in blog using markdown.","date":"2020-08-12","slug":"hello-world","content":"\r\nHello, world!\r\n\r\nThis is my first post on my built-in blog using markdown. The building process itself was a bit challenging, but I learned a lot from this project.\r\n\r\nI learned to:\r\n- Use markdown to write blog posts and process it using Next.js [`getStaticProps`](https://nextjs.org/docs/basic-features/data-fetching/get-static-props), [`react-markdown`](https://github.com/remarkjs/react-markdown), [`chakra-ui-markdown-renderer`](https://github.com/mustaphaturhan/chakra-ui-markdown-renderer) and  using [`react-syntax-highlighter`](https://github.com/react-syntax-highlighter/react-syntax-highlighter) to highlight code snippets on some of my blog entries (with help of internet, of course ðŸ˜ƒ)\r\n- Create a simple CI/CD pipeline using GitHub Actions to deploy my website to GitHub Pages (a lot of failures happened, but I learned a lot from this)\r\n\r\nActually I was planning to use MongoDB Data API to get data from database, but it seems that there is CORS problem with it and I couldn't get it to work. Seems like I should create my own API, then.\r\n\r\nTime to put some markdown notes from past here, I guess."},{"title":"Testing React with Jest and React Testing Library (RTL)","excerpt":"A simple study note written as I take \"Testing React with Jest and React Testing Library (RTL)\" course in Udemy","date":"2020-08-12","slug":"testing-react-with-jest-and-react-testing-library-rtl","content":"\r\nThis is the note I take as I watch this course \r\n[Testing React with Jest and React Testing Library (RTL) - Udemy](https://www.udemy.com/course/react-testing-library/)\r\n\r\n## Introduction\r\n\r\nReact Testing Library (RTL) is a library that provides virtual DOM for React testing. Jest is a framework to run tests that is designed to be used in a CLI. In We write test using a testing function `test()` that takes two arguments: a description of the test and a callback function that contains the test code. \r\n\r\nThe testing processes are basically like using assertions. First we find the element on the app, then we can use assertions to check value of an element (`expect(...).toBe(...)`), and several other assertions are available. It throws error if the assertion fails.\r\n\r\nTesting library recommends finding elements in testing by using accesibility handles. There are several handles, especially `getByText()` (but better using `getByRole()`) and `getByTestId()`. This also encourages us to make the accesibility of the app is better.\r\n\r\n### Test-driven Development\r\n\r\nTest-driven development is a development method that creating test first before building the app. The code then will be implemented with specs from test file. The difference between TDD and BDD (Behavior-driven Development) is that TDD is focused on writing tests first, and BDD is focused on writing code first and involves a lot of people in different roles while the TDD is focused on writing tests first.\r\n\r\nType of tests:\r\n1. Unit tests: Test one small piece of functionality in isolation\r\n2. Integration tests: Test multiple units working together\r\n3. Functional tests: Test a functionality of how users interact in isolation (e.g. fill form and submit)\r\n4. Acceptance/End-to-end (E2E) tests: Test using actual browser and server\r\n\r\n## Examples\r\n\r\nGet button with text \"Change to blue\" and expect it to be red in initial\r\n\r\n```jsx\r\nconst colorButton = screen.getByRole('button', {name: 'Change to blue'});\r\nexpect(colorButton).toHaveStyle({ backgroundColor: 'red' });\r\n```\r\n\r\nExpect button to be red when clicked\r\n\r\n```jsx\r\nfireEvent.click(colorButton);\r\nexpect(colorButton).toHaveStyle({ backgroundColor: 'blue' });\r\n```\r\n\r\n### When to do unit test\r\nSome simple case could be covered by functional tests. But for complicated functions, unit test helps with:\r\n- Covering all possible edge cases\r\n- Determining what caused functional tests to fail\r\nIssue with functional test: High-level makes them resistant to refactors and makes them difficult to diagnose\r\n\r\n## ESLint and Prettier in Testing Library\r\n\r\nESLint: A popular linter for Javascripts. Linter is a tool that analyzes text and marks syntax that breaks rules. Linter analyzes code as written, not what happens when code is run. Linter also can adress format and style, for example, preferred assertion method.\r\n\r\nPrettier: A tool that formats code writing such as indents, spacing, and spaces around curly braces.\r\n\r\nESLint has plugin for testing library and Jest DOM.  Install it by\r\n\r\n```\r\nnpm install eslint-plugin-testing-library eslint-plugin-jest-dom\r\n```\r\n\r\nAt the root directory, create file `.eslintrc.json`.\r\n\r\n```json\r\n{\r\n\t\"plugins\": [\r\n\t\t\"testing-library\", \r\n\t\t\"jest-dom\"\r\n\t],\r\n\t\"extends\" [\r\n\t\t\"react-app\",\r\n\t\t\"react-app/jest\",\r\n\t\t\"plugin:testing-library/recommended\",\r\n\t\t\"plugin:testing-library/react\",\r\n\t\t\"plugin:jest-dom/recommended\"\r\n\t]\r\n}\r\n```\r\n\r\n### Configure ESLint in VSCode\r\n\r\nCreate new file in `.vscode/settings.json`\r\n\r\n```json\r\n{\r\n\t\"editor.codeActionsOnSave\": {\r\n\t\t\"source.fixAll.eslint\": true\r\n\t}\r\n}\r\n```\r\n\r\nAdd `.vscode` and `.eslintcache` to `.gitignore`.\r\n\r\nIf we working on VSCode, we can install ESLint plugin in VSCode. And then allow ESLint to run. If there's red underline mark on code, it means ESLint found error. If we check the error, we can see the error message and sometimes we can quick fix it.\r\n\r\n### Configure Prettier in VSCode\r\n\r\nIn `.vscode/settings.json` (or `settings.json`)\r\n\r\n```json\r\n{\r\n\t\"editor.defaultFormatter\": \"prettier\",\r\n\t\"editor.formatOnSave\": true\r\n}\r\n```\r\n\r\n## Screen Query Methods\r\n\r\nThe format is `command[All]ByQueryType`\r\n\r\n`command`:\r\n- `get`: expect element to be in DOM\r\n- `query`: expect element not to be in DOM\r\n- `find`: expect element to appar async\r\n\r\n`All`:\r\nExpect more than one match. If you want to expect only one match, exclude it.\r\n\r\n`ByQueryType`:\r\n- `ByRole`: expect element with role\r\n- `ByAltText`: expect element with alt text (for images)\r\n- `ByText`: expect element with text\r\n- Form elments:\r\n\t- `ByPlaceholderText`: expect element with placeholder text\r\n  - `ByLabelText`: expect element with label text\r\n\t- `ByDisplayValue`: expect element with display value\r\n\r\nMore references on screen query on the docs\r\n\r\n## Simulating Server Response with Mock Service Worker\r\n\r\nIn testing the network stuffs like fetching data from server, we need to simulate the server response. We can use mock service worker to simulate the server response.\r\n\r\n### Setup\r\n\r\n```\r\nnpm install msw\r\n```\r\n\r\nCreate file `mocks/handlers.js`.\r\n\r\n```js\r\nimport { rest } from 'msw';\r\n\r\nexport const handlers = [\r\n\trest.get(..., (req, res, ctx) => {\r\n\t\treturn res(ctx.json([\r\n\t\t\t{ ... },\r\n\t\t\t{ ... },\r\n\t\t\t{ ... },\r\n\t\t]));\r\n\t}),\r\n]\r\n```\r\n\r\nCreate file `mocks/server.js`\r\n\r\n```js\r\nimport { setupServer } from 'msw/node';\r\nimport { handlers } from './handlers';\r\n\r\nexport const server = setupServer(...handlers);\r\n```\r\n\r\n### Test with Mock Service Worker\r\n\r\n```jsx\r\nimport { render, screen } from '@testing-library/react';\r\n...\r\n\r\ntest(..., () => {\r\n\trender(<... />);\r\n\r\n\tconst scoopImages = screen.getAllByRole('img', { name: ... });\r\n\texpect(scoopImages).toHaveLength(2);\r\n\r\n\t// @ts-ignore\r\n\tconst altTexts = scoopImages.map((element) => element.alt);\r\n\texpect(altTexts).toEqual([..., ...]);\r\n})\r\n```\r\n\r\n### Simulating Server Error Response\r\n\r\n```jsx\r\nimport { render, screen } from '@testing-library/react';\r\nimport { rest } from 'msw';\r\nimport { server } from '.../mocks/server';\r\n\r\ntest('handles error', async () => {\r\n\tserver.resetHandlers(\r\n\t\trest.get('http://localhost:3030/scoops', (req, res, ctx) => {\r\n\t\t\treturn res(ctx.status(500));\r\n\t\t}),\r\n\t\trest.get('http://localhost:3030/toppings', (req, res, ctx) => {\r\n\t\t\treturn res(ctx.status(500));\r\n\t\t}),\r\n\t);\r\n\r\n\trender(<... />);\r\n\r\n\tconst alerts = await screen.findAllByRole('alert', { name: ... });\r\n\r\n\texpect(alerts).toHaveLength(2);\r\n});\r\n```\r\n\r\n## Testing Components Wrapped in a Provider\r\n\r\n```jsx\r\nimport { render, screen } from '@testing-library/react';\r\n...\r\n\r\ntest(... async () => {\r\n\trender(<... />);\r\n\r\n\tconst scoopSubtotal = ...;\r\n\texpect(scoopSubtotal).toHaveTextContent(...);\r\n\r\n\tconst vanillaInput = await screen.findByRole(..., { name: ... });\r\n\tawait userEvent.clear(vanillaInput); // clear first\r\n\tawait userEvent.type(vanillaInput, ...);\r\n\texpect(scoopSubtotal).toHaveTextContent(...);\r\n})\r\n```\r\n\r\nWrap isolated component in a provider\r\n\r\n```jsx\r\n...\r\nimport { ... } from '.../contexts/...'\r\n\r\ntest(..., async () => {\r\n\trender(<... />, { wrapper: ... });\r\n})\r\n```\r\n\r\n### Create custom render to wrap in provider by default\r\n\r\nWe can do this by creating test utilities and change the import statement to use the test utilities we made.\r\n\r\nCreate file `test-utils/testing-library-utils.jsx`\r\n\r\n```jsx\r\nimport { render } from '@testing-library/react';\r\nimport { CustomProvider } from ...;\r\n\r\nconst renderWithContext = (ui, options) => {\r\n\treturn render(ui, { wrapper: CustomProvider, ...options });\r\n}\r\n\r\nexport * from '@testing-library/react';\r\n\r\nexport { renderWithContext as render };\r\n```\r\n\r\nIn test file that needs custom render, change all render and screen imports.\r\n\r\n```jsx\r\nimport { render, screen } from '.../test-utils/testing-library-utils';\r\n...\r\n\r\ntest(..., async () => {\r\n\trender(<... />);\r\n\t...\r\n}\r\n```\r\n\r\n"},{"title":"Intermediate React, v4 - Notes","excerpt":"A simple study note written as I take \"Intermediate React, v4\" course in FrontendMasters","date":"2020-08-11","slug":"intermediate-react-v4-notes","content":"\r\nThis is the note I take as I watch this course \r\n[Intermediate React, v4 | FrontendMasters](https://frontendmasters.com/courses/intermediate-react-v4/)\r\n\r\n## Hooks in Depth\r\n\r\n### `useState`\r\n\r\nLets you manage state of React component.\r\n\r\n### `useEffect`\r\n\r\nLets you call side effect for component outside of normal render cycle. Second argument is used to determine dependencies. \r\n\r\n### `useContext`\r\n\r\nIf not using useContext, we have to pass context to component several levels lower way down (prop drilling). We can access/update context from child level. Using useContext solve this problem like a global variable, but it don't show the explicit relationship between components.\r\n\r\n### `useRef`\r\n\r\nuseRef difference from useState is that it's a reference to the DOM element. useState will be changed when component re-renders, but useRef will be changed when component unmounts.\r\n\r\n### `useReducer`\r\n\r\nBasically useState with extra steps to manage state using dispatch, break it and make it testable. Using the reducer with the same state and action will always return the same new state.\r\n\r\n### `useMemo`\r\n\r\nuseMemo is a function that memoizes a function or value. It's useful when you want to memoize a function that is expensive to compute or when you want to memoize a value that you expect to be constant (no need to recalculate).\r\n\r\n### `useCallback`\r\n\r\nSame as useMemo, useCallback is used for performance optimization. It's a function that memoizes a function and only recalculates if the dependencies change.\r\n\r\n### `useLayoutEffect`\r\n\r\nSame as useEffect, but it's called after the component has been mounted. It's synchronous to render. This is helpful because useLayout runs the same time as `componentDidMount` and `componentDidUpdaete` in class component, where `useEffect` is scheduled after. Use `useLayoutEffect` if it is guaranteed that the effect will run synchronously after the component has been mounted.\r\n\r\n### `useImperativeHandle`\r\n\r\nuseImperativeHandle is a function that lets you customize methods of object that is returned from useRef hook.  It's useful when you want to pass a ref to a component that is not a child of the component you are using it in, expecially on creating libraries.\r\n\r\n### `useDebugValue` & `useId`\r\n\r\nuseDebugValue can be used to expose custom value while debugging custom hooks in DevTools. useId is a function that generate a unique ID.\r\n\r\n## TailwindCSS\r\n\r\n### CSS & React\r\n\r\nTailwind is not tied to React. It's a CSS framework.\r\n\r\nInstall:\r\n```sh\r\nnpm i -D tailwindcss@3.0.22 postcss@8.4.6 autoprefixer@10.4.2\r\n```\r\n\r\nInit Tailwind project:\r\n```sh\r\nnpx tailwindcss init\r\n```\r\n\r\nThis will create a tailwind config in `tailwind.config.js`.\r\n\r\nThen add these line in the beginning of the global CSS file\r\n\r\n```css\r\n@tailwind base;\r\n@tailwind components;\r\n@tailwind utilities;\r\n```\r\n\r\nThen create `.postcssrc` in root directory\r\n\r\n```json\r\n{\r\n  \"plugins\": {\r\n    \"autoprefixer\": {},\r\n    \"tailwindcss\": {}\r\n  }\r\n}\r\n```\r\n\r\n### Basics & Gradients\r\n\r\nBasically, working with Tailwind CSS require us to implement CSS rules via adding `className` to our component so component will have a long className string from Tailwind. But sometimes we will have to add some custom style e.g. background image because Tailwind doesn't support it.\r\n\r\n```jsx\r\n<div\r\n\tclassName=\"p-0 m-0\"\r\n\tstyle={{\r\n\t\tbackground: \"url(http://pets-images.dev-apis.com/pets/wallpaperA.jpg)\",\r\n\t}}\r\n>\r\n  \t...\r\n</div>\r\n```\r\n\r\nMore Tailwind CSS class can be found at the docs.\r\n\r\n### CSS Libraries\r\n\r\nUsing Tailwind will make our CSS size much smaller. There are several other tools to do styling, including emotion and styled-components. They are good if we need to have some javascript functionality in our CSS like computing colors, etc.\r\n\r\n### Layout Basics\r\n\r\nWe can also use Tailwind to layout our components using flex.\r\n\r\n### Tailwind Plugins\r\n\r\nThere are several component styling by Tailwind CSS. Install it with\r\n\r\n```sh\r\nnpm install -D @tailwindcss/forms@0.4.0.\r\n```\r\n\r\nThis will apply some default styling to basic form elements. In text input, add `type=text` so it will be styled as a text input.\r\n\r\n### Grid & Breakpoints\r\n\r\nWe can also use Tailwind to layout our components using grid and it's much easier than using pure CSS. We can also make it responsive.\r\n\r\n### Positioning\r\n\r\nWe can also have relative positioning in CSS.\r\n\r\n## Code Splitting & Server Side Rendering\r\n\r\n### Code Splitting\r\n\r\nCode splitting is a technique to split our application into smaller parts so the application won't be loaded all at once. This is useful when we have a big application and we want to load it faster. To implement this, we can use `Suspense` and `React.lazy` in router.\r\n\r\n```jsx\r\nimport { useState, StrictMode, lazy, Suspense } from \"react\";\r\n\r\nconst Details = lazy(() => import(\"./Details\"));\r\nconst SearchParams = lazy(() => import(\"./SearchParams\"));\r\n\r\nconst App = () => {\r\n\treturn (\r\n\t\t<Suspense fallback={<h1>loading route...</h1>}>\r\n\t\t\t<BrowserRouter>\r\n\t\t\t\t...\r\n\t\t\t</BrowserRouter>\r\n\t\t</Suspense>\r\n\t);\r\n}\r\n```\r\n\r\nOther than this, the code can be load asynchronously with `lazy`.\r\n\r\n```jsx\r\nimport { ..., lazy } from \"react\";\r\n\r\nconst Modal = lazy(() => import(\"./Modal\"));\r\n```\r\n\r\n### Server Side Rendering\r\n\r\nPerformance is a big concern when we have a big application. There are several ways to improve performance. One challenge is to load the correct content first so user can see the site faster.\r\n\r\nServer side rendering is a technique to run React on the server before send it to the user and send the first rendering of the application. The user will only has to download the HTML and see the page, otherwise the user has to download HTML, JS, and load it before showing anything. The total time is relative slower because the React app is loading in the background, but the time the user see something on the page is much faster.\r\n\r\nTo implement SSR, we have o change where our app is rendered. We use `hydrate` from `react-dom` instead of `render`, and then achieve it using Express and Node.\r\n\r\n### Streaming Markup\r\n\r\nWe can use *streaming* when making HTTP request so we can send response in chunks (partially rendered) instead of sending the whole big payload at the end. Browser can immediately start downloading CSS while the app is loading. To implement this, we can use `renderToNodeStream` from `react-dom/server`.\r\n\r\n## TypeScript\r\n\r\nTypescript make you write javascript code in a more strict way. It's a good way to make sure your team don't make mistakes as the project scales up. TypeScript make the code more readable and maintainable.\r\n\r\n### Setup & Refactoring\r\n\r\nInstall\r\n\r\n```sh\r\nnpm install -D typescript@4.5.5\r\n```\r\n\r\nThen run\r\n```sh\r\nnpx tsc --init\r\n```\r\n\r\nIt will generate `tsconfig.json` file. Some React dependency types are required to be installed.\r\n\r\n```sh\r\nnpm install -D @types/react@17.0.39 @types/react-dom@17.0.11\r\n```\r\n\r\n### TypeScript & ESLint\r\n\r\nThere is a project called `typescript-eslint` to replace TSLint (deprecated) that can be used to lint TypeScript code using ESLint.\r\n\r\n```sh\r\nnpm install -D eslint-import-resolver-typescript@2.5.0 @typescript-eslint/eslint-plugin@5.13.0 @typescript-eslint/parser@5.13.0\r\n```\r\n\r\nChange `package.json` \"lint\" entry to \r\n```json\r\n\"scrips\": {\r\n\t...\r\n\t\"lint\": \"eslint \\\"src/**/*.{js,jsx,ts,tsx}\\\" --quiet\",\r\n\t...\r\n}\r\n```\r\n\r\nModify `.eslintrc.json`\r\n\r\n```json\r\n{\r\n\t\"extends\": [\r\n\t\t...,\r\n\t\t\"plugin:@typescript-eslint/recommended\",\r\n\t\t\"plugin:@typescript-eslint/recommended-requiring-type-checking\",\r\n\t\t\"prettier\"\r\n\t],\r\n\t\"rules\": {\r\n\t\t...,\r\n\t\t\"@typescript-eslint/no-empty-function\": 0\r\n\t},\r\n\t\"plugins\": [..., \"@typescript-eslint\"],\r\n\t\"parserOptions\": {\r\n\t\t...,\r\n\t\t\"project\": [\"./tsconfig.json\"],\r\n\t\t...\r\n\t}\r\n\t...,\r\n\t\"settings\": {\r\n\t\t...,\r\n\t\t\"import/parsers\": {\r\n\t\t\t\"@typescript-eslint/parser\": [\".ts\", \".tsx\"]\r\n\t\t},\r\n\t\t\"import/resolver\": {\r\n\t\t\t\"typescript\": {\r\n\t\t\t\t\"alwaysTryTypes\": true\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\n### TypeScript Basic Notes\r\n\r\n1. We can have a strict ordering of string and function which will be enforced to make other file easier to type.\r\n\r\n2. `interface` is a way to define a object-like type that can be used in other file. Use interfaces unless you need type aliases.\r\n\r\n\t```ts\r\n\t// by export it, we can use it in other file\r\n\texport interface Pet {\r\n\t\tid: number;\r\n\t\tname: string;\r\n\t\t...\r\n\t}\r\n\r\n\texport interface PetAPIResponse {\r\n\t\tnumberOfResults: number;\r\n\t\t...\r\n\t}\r\n\t```\r\n\r\n3. We can make a custom, more-strict type alias that just allows a few different values by declare it with `type`.\r\n\r\n\t```ts\r\n\texport type Animal = \"dog\" | \"cat\";\r\n\t```\r\n\r\n4. The type of a value can be enforced with `... as ...` syntax.\r\n\r\n5. If the param can be undefined, we can use `?` to make it optional.\r\n\r\nAdd type check to `package.json`\r\n\r\n```json\r\n\"scripts\": {\r\n\t...,\r\n\t\"typecheck\": \"tsc --noEmit\",\r\n\t...\r\n}\r\n```\r\n\r\n## Redux\r\n\r\nRedux is a library that does state management. Back then, Redux was made to replace Context that used to be worse in React. One feature of Redux is that it is testable.\r\n\r\nInstall Redux\r\n\r\n```sh\r\nnpm install redux@4.1.2 react-redux@7.2.6\r\n```\r\n\r\nIncluding Redux middleware\r\n```js\r\nimport { createStore } from \"redux\";\r\nimport reducer from \"./reducers\";\r\n\r\nconst store = createStore(\r\n\treducer,\r\n\ttypeof window === \"object\" &&\r\n\t\ttypeof window.__REDUX_DEVTOOLS_EXTENSION__ !== \"undefined\"\r\n\t\t? window.__REDUX_DEVTOOLS_EXTENSION__()\r\n\t\t: (f) => f\r\n);\r\n\r\nexport default store;\r\n```\r\n### Reducers\r\n\r\ncombineReducers is a function that takes an object of reducers and returns a reducer function.\r\n\r\n```js\r\nimport { combineReducers } from \"redux\";\r\nimport location from \"./location\";\r\n\r\nexport default combineReducers({\r\n  location,\r\n  ...\r\n});\r\n```\r\n\r\nReducer takes an old state, an action, and combines those things to make a state. A reducer must have a default state. Reducer are synchronous.\r\n\r\n```js\r\nexport default function location(state = \"Seattle, WA\", action) {\r\n  switch (action.type) {\r\n    case \"CHANGE_LOCATION\":\r\n      return action.payload;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n```\r\n\r\n### Action Creators\r\n\r\nAction Creators are functions that return action objects.\r\n\r\n```js\r\nexport default function changeTheme(theme) {\r\n  return { type: \"CHANGE_THEME\", payload: theme };\r\n}\r\n```\r\n\r\n### Providers & Dispatching Actions\r\n\r\nProvider is a component that wraps the app and provides the store to the app.\r\n\r\n```jsx\r\nimport { Provider } from \"react-redux\";\r\nimport store from \"./store\";\r\n\r\nconst App = () => {\r\n\treturn (\r\n\t\t<Provider store={store}>\r\n\t\t\t<App />\r\n\t\t</Provider>\r\n\t);\r\n}\r\n```\r\n\r\nNow we can use Redux in component.\r\n\r\n```jsx\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport changeLocation from \"./actionCreators/changeLocation\";\r\n...\r\n\r\nconst location = useSelector((state) => state.location);\r\n...\r\nconst dispatch = useDispatch();\r\n\r\nconst SearchParams = () => {\r\n\treturn (\r\n\t\t...\r\n\t\t<input\r\n\t\t\tid=\"location\"\r\n\t\t\tvalue={location}\r\n\t\t\tplaceholder=\"Location\"\r\n\t\t\tonChange={(e) => dispatch(changeLocation(e.target.value))}\r\n\t\t/>\r\n\t\t...\r\n\t)\r\n}\r\n```\r\n\r\n\r\n### Redux Dev Tools\r\n\r\nRedux Dev Tools is a browser extension that allows us to see the state of the store.\r\n\r\n## Testing\r\n\r\nJest is a testing library that allows us to write tests in JavaScript. It is built on top of Jasmine.\r\n\r\nInstall Jest\r\n```sh\r\nnpm install -D jest@27.5.1 @testing-library/react@12.1.3\r\n```\r\n\r\nReplace `.babelrc` with\r\n```json\r\n{\r\n  \"presets\": [\r\n    [\r\n      \"@babel/preset-react\",\r\n      {\r\n        \"runtime\": \"automatic\"\r\n      }\r\n    ],\r\n    \"@babel/preset-env\"\r\n  ],\r\n  \"plugins\": [\"@babel/plugin-proposal-class-properties\"],\r\n  \"env\": {\r\n    \"test\": {\r\n      \"presets\": [\r\n        [\r\n          \"@babel/preset-env\",\r\n          {\r\n            \"targets\": {\r\n              \"node\": \"current\"\r\n            }\r\n          }\r\n        ]\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nAdd `test` script to `package.json`\r\n```json\r\n\"scripts\": {\r\n\t...,\r\n\t\"test\": \"jest\",\r\n\t\"test:watch\": \"jest --watch\"\r\n\t...\r\n}\r\n```\r\n\r\n### Basic React Testing\r\n\r\n- Try to test functionality, not implementation\r\n- Don't test UI or something that likely to change, test the action to the UI instead\r\n- Test the important part to the user\r\n- Delete test on a regular basis\r\n- Fix/delete bad test\r\n\r\nBasic test file has extension `.test.js` or `.spec.js`\r\n\r\n```js\r\nimport { expect, test } from \"@jest/globals\";\r\nimport { render } from \"@testing-library/react\";\r\nimport Pet from \"../Pet.js\"; // the component\r\n\r\ntest(\"displays a default thumbnail\", async () => { // test case\r\n  const pet = render(<Pet />);\r\n\r\n  const petThumbnail = await pet.findByTestId(\"thumbnail\");\r\n  expect(petThumbnail.src).toContain(\"none.jpg\");\r\n});\r\n```\r\n\r\n`findByTestId` is a function that finds a component by its test id. To catch a specific component for testing, we can add a `data-testid` attribute to the component.\r\n\r\nFor testing custom hooks, we can make a fake component, or using `@testing-library/react-hooks`, then we can use `renderHook` to render a component.\r\n\r\n### Mocks\r\n\r\nTo test a component that uses a library that is not available in the browser, we can mock the library. A mock is a fake implementation.\r\n\r\nInstall\r\n\r\n```sh\r\nnpm install -D jest-fetch-mock@3.0.3\r\n```\r\n\r\nAdd to `package.json`\r\n\r\n```json\r\n{\r\n  \"jest\": {\r\n    \"automock\": false,\r\n    \"setupFiles\": [\"./src/setupJest.js\"]\r\n  }\r\n}\r\n```\r\n\r\nCreate `setupJest.js` in root.\r\n\r\n```js\r\nimport { enableFetchMocks } from \"jest-fetch-mock\";\r\n\r\nenableFetchMocks();\r\n```\r\n\r\nImplement in testing\r\n\r\n```js\r\ntest(\"...\", async () => {\r\n\tconst breeds = [\r\n\t\t...\r\n\t];\r\n\tfetch.mockResponseOnce(\r\n\t\tJSON.stringify({\r\n\t\tanimal: \"...\",\r\n\t\tbreeds,\r\n\t\t})\r\n\t);\r\n\tconst { result, waitForNextUpdate } = renderHook(() => useBreedList(\"dog\"));\r\n\tawait waitForNextUpdate();\r\n\t...\r\n});\r\n```\r\n\r\n### Snapshots\r\n\r\nSnapshot tests are a low-cost way to write tests.\r\n\r\n```sh\r\nnpm install -D react-test-renderer@17.0.2.\r\n```\r\n\r\nAdd\r\n```js\r\n/**\r\n * @jest-environment jsdom\r\n */\r\n\r\nimport { expect, test } from \"@jest/globals\";\r\nimport { create } from \"react-test-renderer\";\r\nimport Results from \"../Results\";\r\n\r\ntest(\"renders correctly with no pets\", () => {\r\n  const tree = create(<Results pets={[]} />).toJSON();\r\n  expect(tree).toMatchSnapshot();\r\n});\r\n```\r\n\r\nThe snapshot will show on the CLI and create a `__snapshots__` folder.\r\n\r\n### Test Coverage with Istanbul\r\n\r\nAdd command to `package.json`\r\n\r\n```json\r\n\"scripts\": {\r\n\t...,\r\n\t\"test:coverage\": \"jest --coverage\"\r\n\t...\r\n}\r\n```\r\n\r\nThe script will generate a report of things that are covered and not coveredd with tests. It will also generate a `index.html` file open in the browser by running\r\n```sh\r\nopen coverage/lcov-report/index.html\r\n```\r\n\r\nAdd `coverage` to `.gitignore`"},{"title":"Complete Intro to React, v7 - Notes","excerpt":"A simple study note written as I take \"Complete Intro to React, v7\" course in FrontendMasters","date":"2020-08-06","slug":"complete-intro-to-react-v7-notes","content":"\r\nThis is the note I take as I watch this course \r\n[Complete Intro to React, v7 - FrontendMasters](https://frontendmasters.com/courses/complete-react-v7/)\r\n## Vanilla React\r\n\r\nReact can be used purely by importing the react script in HTML.\r\n\r\n````HTML\r\n<body>\r\n  <div id=\"root\">not rendered</div>\r\n  <script src=\"https://unpkg.com/react@17.0.2/umd/react.development.js\"></script>\r\n  <script src=\"https://unpkg.com/react-dom@17.0.2/umd/react-dom.development.js\"></script>\r\n  <script>\r\n    // Your code is going to go here\r\n  </script>\r\n</body>\r\n````\r\n\r\nThen we put our code in the last script tag.\r\n\r\n```js\r\nconst App = () => {\r\n  return React.createElement(\r\n    \"div\",\r\n    {},\r\n    React.createElement(\"h1\", {}, \"Adopt Me!\")\r\n  );\r\n};\r\n\r\nReactDOM.render(React.createElement(App), document.getElementById(\"root\"));\r\n```\r\n\r\nTo implement best practice, we could separate the code into a separate file called `App.js` then import it in the HTML file with `<script src=\"App.js\"></script>`.\r\n\r\n### Component\r\n\r\nCreate component that return element with multiple children with passing it in array of elements. \r\n```js\r\nconst Pet = () => {\r\n  return React.createElement(\"div\", {}, [\r\n    React.createElement(\"h1\", {}, \"Luna\"),\r\n    React.createElement(\"h2\", {}, \"Dog\"),\r\n    React.createElement(\"h2\", {}, \"Havanese\"),\r\n  ]);\r\n};\r\n```\r\n\r\nThe component will be used inside the `App` component.\r\n```jsx\r\nconst App = () => {\r\n  return React.createElement(\r\n    \"div\",\r\n    {},\r\n    React.createElement(\"h1\", {}, \"Adopt Me!\"),\r\n    ...\r\n    React.createElement(Pet)\r\n  );\r\n}\r\n```\r\n\r\nAdd props to the element\r\n```jsx\r\nconst Pet = (props) => {\r\n  return React.createElement(\"div\", {}, [\r\n    React.createElement(\"h1\", {}, props.name),\r\n    React.createElement(\"h2\", {}, props.animal),\r\n    React.createElement(\"h2\", {}, props.breed),\r\n  ]);\r\n};\r\n\r\nconst App = () => {\r\n    return React.createElement(\"div\", {}, [\r\n      React.createElement(\"h1\", {}, \"Adopt Me!\"),\r\n      ...\r\n      React.createElement(Pet, {\r\n        name: \"Luna\",\r\n        animal: \"Dog\",\r\n        breed: \"Havanese\"\r\n      })\r\n    ]);\r\n}\r\n```\r\n\r\n## JS Tools\r\n\r\n### npm (Node Package Manager)\r\n\r\nBring various open source code modules to import into the project.\r\n\r\nTo initialize, run\r\n```sh\r\nnpm init -y\r\n```\r\nIt will make a new file called `package.json` in the root directory.\r\n\r\n### Prettier\r\n\r\nRe-print the code with a predefined style. This is a good way to make sure the code is formatted correctly.\r\n\r\nTo install prettier globally, run\r\n```sh\r\nnpm install --global prettier\r\n```\r\n\r\nTo declare a project as a prettier project, create a file `.prettierrc`. This configuration could be either empty (only contains `{}`) or have some configuration.\r\n\r\nTo manually format the code, run\r\n```sh\r\nprettier --write \\\"src/**/*.{js,jsx}\\\"\r\n```\r\n\r\nWe can also set up a CLI command in the `package.json` to format the code automatically.\r\n\r\n```json\r\n\"scripts\": {\r\n  \"format\": \"prettier --write \\\"src/**/*.{js,jsx}\\\"\"\r\n}\r\n```\r\n\r\nThen we can use `npm run format` to format the code.\r\n\r\n### ESLint\r\n\r\nIt is a linter to enforce a style guide for JavaScript code.\r\n\r\nTo install ESLint, run\r\n```sh\r\nnpm install -D eslint@8.8.0 eslint-config-prettier@8.3.0\r\n```\r\n\r\nThere are so many preset configs. To create a new config, create a file `.eslintrc.json`.\r\n\r\n```json\r\n{\r\n  \"extends\": [\"eslint:recommended\", \"prettier\"],\r\n  \"plugins\": [],\r\n  \"parserOptions\": {\r\n    \"ecmaVersion\": 2022,\r\n    \"sourceType\": \"module\",\r\n    \"ecmaFeatures\": {\r\n      \"jsx\": true\r\n    }\r\n  },\r\n  \"env\": {\r\n    \"es6\": true,\r\n    \"browser\": true,\r\n    \"node\": true\r\n  }\r\n}\r\n```\r\n\r\nTo run ESLint, add the CLI command to `\"scripts\"`.\r\n```sh\r\n\"lint\": \"eslint \\\"src/**/*.{js,jsx}\\\" --quiet\",\r\n```\r\n\r\n### Git\r\n\r\nThere are several things that shouldn't we commit to repo. Add to `.gitignore`\r\n\r\n- `node_modules`\r\n- `.parcel-cache/`\r\n- `dist/`\r\n- `.env`\r\n- `.DS_Store`\r\n- `coverage/`\r\n- `.vscode/`\r\n\r\n### Parcel\r\n\r\nA bundler for modern JavaScript applications. It crawl through the project and bundle all the files together and then run the code on a server.\r\n\r\nInstall Parcel with\r\n```sh\r\nnpm install -D parcel@2.2.1\r\n```\r\n\r\nInside the `package.json` file, add the following script to `\"scripts\"`.\r\n```sh\r\n\"dev\": \"parcel src/index.html\",\r\n```\r\n\r\nThen we can use `npm run dev` to run the app. The app will be served on `localhost`. It will automatically watch for changes and rebuild the app.\r\n\r\n### Browserslist\r\n\r\nTransforms JS code from futuristic code to code that is understandable by older browsers with Babel.\r\n\r\nBrowserslist are intstalled with Parcel and can be used to specify the browsers that the code will be transpiled to. Add to `package.json`\r\n\r\n```json\r\n{\r\n    ...\r\n    \"browserslist\": [\r\n        \"last 2 Chrome versions\"\r\n    ]\r\n}\r\n```\r\n\r\n## Core React Concepts\r\n\r\n### JSX\r\n\r\nMakes code more readable and more HTML-like. React component in JSX should be written in capitalized format.\r\n\r\n```jsx\r\nconst Pet = (props) => {\r\n  return (\r\n    <div>\r\n      <h1>{props.name}</h1>\r\n      <h2>{props.animal}</h2>\r\n      <h2>{props.breed}</h2>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Pet;\r\n```\r\n\r\nJavascript expression inside the return value is wrapped in `{}` e.g. `{props.name}`.\r\n\r\n### Hooks\r\n\r\nHooks get caught every time a component is rendered. We can keep pieces of mutable state and modify them later using the updater functions.\r\n\r\nTo add a hook \r\n\r\n**useState**\r\n\r\n`const [state, setState] = useState(initialState)`. \r\n\r\nState is the piece of mutable state and setState is the updater function. The updater function is used to update the state value.\r\n\r\n```jsx\r\nimport { useState } from \"react\";\r\n\r\nconst App = () => {\r\n    const [location, setLocation] = useState(\"\");\r\n    return (\r\n        <input\r\n            id=\"location\"\r\n            value={location}\r\n            placeholder=\"Location\"\r\n            onChange={(e) => setLocation(e.target.value)}\r\n        />\r\n    );\r\n}\r\n```\r\n\r\n**useEffect**\r\n\r\nAllows to say \"do a render of this component first so the user can see something then as soon as the render is done, then do something (the something here being an effect.)\". The effect is a function that is called when the component is rendered.\r\n\r\nTo let the user see the UI first before make request to API, we put the request API in the `useEffect` hook.\r\n\r\n```jsx\r\n// change import at top\r\nimport { useEffect } from \"react\";\r\n\r\nconst App () => {\r\n    useEffect(() => {\r\n      requestPets();\r\n    }, []); // dependent var. will call exactly once.\r\n    // if we want it to call every time breed changes, change [] to [breed]\r\n    // if no second argument, it will call everytime the component is rendered (anything changes).\r\n    \r\n    async function requestPets() {\r\n      const res = await fetch(\r\n        ...\r\n      );\r\n    }\r\n    \r\n    ...\r\n}\r\n```\r\n\r\n**Custom Hooks**\r\n\r\nWe can use one or several react hooks to make a reusable custom hooks.\r\n\r\n```jsx\r\nimport { useState, useEffect } from \"react\";\r\n\r\nexport default function useBreedList(animal) {\r\n  const [breedList, setBreedList] = useState([]);\r\n  const [status, setStatus] = useState(\"unloaded\");\r\n\r\n  useEffect(() => {\r\n    if (!animal) {\r\n      ...\r\n    }\r\n\r\n    async function requestBreedList() {\r\n      ...\r\n    }\r\n  }, [animal]);\r\n\r\n  return [breedList, status];\r\n}\r\n```\r\n\r\nThe function will return two things. We can use the hooks like this\r\n\r\n```jsx\r\nimport useBreedList from \"./useBreedList\";\r\n\r\nconst [breeds] = useBreedList(animal);\r\n```\r\n\r\n### Handling User Input\r\n\r\nTo listen to user actions on input like submit events\r\n\r\n```jsx\r\n<form\r\n  onSubmit={e => {\r\n    e.preventDefault();\r\n    requestPets();\r\n  }}\r\n>\r\n```\r\n\r\nThere are other listener like `onChange`, on mouse enter, key pres, copy paste, etc.\r\n\r\n### React Dev Tools\r\n\r\n**`NODE_ENV=development`**\r\n\r\nWhen using Parcel, there are some developer conveniences for debugging stuffs to help in development. When building the app, the environment variable will be `NODE_ENV=production` to strip the development tools and make the bundle smaller.\r\n\r\n**<React.StrictMode>**\r\n\r\nWill give additional warnings about things that might be wrong in React usage.\r\n\r\n**DevTools extension**\r\n\r\nExtension to explore DOM tree, modify state, props, etc.\r\n\r\n## React Capabilities\r\n\r\n### React Router\r\n\r\nInstall\r\n\r\n```sh\r\nnpm install react-router-dom@6.2.1\r\n```\r\n\r\nTo use\r\n\r\n```jsx\r\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\";\r\n\r\nconst App = () => {\r\n  return (\r\n    <BrowserRouter>\r\n      ...\r\n      <Routes>\r\n        <Route path=\"/details/:id\" element={<Details />} />\r\n        <Route path=\"/\" element={<SearchParams />} />\r\n      </Routes>\r\n    </BrowserRouter>\r\n  );\r\n}\r\n```\r\n\r\nTo make link to page, use `<Link>` so React won't totally reload the entire app all over again when clicked.\r\n\r\n```jsx\r\n<Link to={`/details/${id}`} className=\"pet\">\r\n  ...\r\n</Link>;\r\n```\r\n\r\nTo get the `id` params from the URL, use `useParams()`.\r\n\r\n```jsx\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nconst Details = () => {\r\n  const { id } = useParams();\r\n  return (\r\n    ..\r\n  );\r\n}\r\n```\r\n\r\n### Class Components\r\n\r\nUse class as a way to declare a component.\r\n\r\n```jsx\r\nimport { Component } from \"react\";\r\n...\r\n\r\nclass Details extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      ...\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    ...\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        ...\r\n      </div>\r\n    );\r\n  }\r\n}\r\n```\r\n\r\nClass elements:\r\n\r\n- Declaration: React class extends `React.Component` and have one render method that returns JSX.\r\n- `constructor()`: We can set the initial state. We have to write `super(props)` at the beginning so it also run the constructor of the parent class.\r\n- `componentDidMount()`: Called after the component is rendered. Usage example: to make a request to API.\r\n- `this.state`: Mutable state of component, use `this.setState` to modify\r\n- `this.props`: Come from parent component, immutable.\r\n\r\nIf working with hooks, we make wrapper component that uses the hook and pass the jsx returns to the wrapper component.\r\n\r\n```jsx\r\nclass Details extends Component {\r\n  ...\r\n  render() {\r\n    ...\r\n    return (\r\n      ...\r\n    );\r\n}\r\n\r\nconst WrappedDetails = () => {\r\n  const params = useParams();\r\n  return (\r\n    <Details params={params} />\r\n  );\r\n}\r\n```\r\n\r\n### Class Properties\r\n\r\nInstall a Babel plugin to use class properties to replace constructor.\r\n\r\n```sh\r\nnpm i -D @babel/plugin-proposal-class-properties@7.16.7\r\n```\r\n\r\nMake file `.babelrc`\r\n\r\n```json\r\n{\r\n  \"plugins\": [\"@babel/plugin-proposal-class-properties\"]\r\n}\r\n```\r\n\r\nThe constructor in class Details can be replaced to\r\n\r\n```jsx\r\nclass Details extends Component {\r\n  state = { loading: true };\r\n  ...\r\n}\r\n```\r\n\r\n### Managing State in Class Components\r\n\r\nWe can have defaultProps in class components to set props that a component has by default if it's not passed from the parent.\r\n\r\nMake event listener\r\n\r\n```jsx\r\nhandleIndexClick = event => {\r\n  this.setState({\r\n    ...\r\n  });\r\n}\r\n...\r\n<img \r\n  onClick={this.handleIndexClick} \r\n  ... \r\n/>\r\n```\r\n\r\n## Special Case React Tools\r\n\r\n### Error Boundaries\r\n\r\nTo catch errors in components.\r\n\r\n```jsx\r\nclass ErrorBoundary extends Component {\r\n  state = { hasError: false };\r\n  static getDerivedStateFromError() {\r\n    return { hasError: true };\r\n  }\r\n\r\n  componentDidCatch(error, info){\r\n    console.error(\"ErrorBoundary caught an error\", error, info);\r\n  }\r\n\r\n  render () {\r\n    if (this.state.hasError) {\r\n      return ...\r\n    }\r\n\r\n    return ...\r\n  }\r\n}\r\n...\r\n```\r\n\r\nNow wrap the component with `<ErrorBoundary>` and catch the error.\r\n```jsx\r\nconst WrappedDetails = () => {\r\n  ...\r\n  return (\r\n    <ErrorBoundary>\r\n      ...\r\n    </ErrorBoundary>\r\n  )\r\n}\r\n```\r\n\r\nTo make redirect automatically, use `componentDidUpdate`\r\n\r\n```jsx\r\nclass Details extends Component {\r\n  state = { hasError: false, redirect: false };\r\n  ...\r\n\r\n  componentDidUpdate() {\r\n    if (this.state.hasError) {\r\n      setTimeout(() => this.setState({ redirect: true }), 5000);\r\n    }\r\n  }\r\n\r\n  ...\r\n  \r\n  if (this.state.redirect) {\r\n    return <Navigate to=\"/\" />;\r\n  } } else if (this.state.hasError) {\r\n    ...\r\n  }\r\n}\r\n```\r\n\r\n### Context\r\n\r\nContext is like global state in application. Mostly replaces Redux. Context won't really be used in most of applications, only use when needed.\r\n\r\n```jsx\r\nimport { createContext } from \"react\";\r\n\r\nconst ThemeContext = createContext([\"green\", () => {}]);\r\n\r\n...\r\n```\r\n\r\n`createContext` returns two object, `Provider` and `Consumer`. Provider is the component that provides the context and Consumer is the component that consumes the context. Consumer accept function as a child and give it to the context. To use the consumer, use `useContext`.\r\n\r\n```jsx\r\nimport ThemeContext from \"./ThemeContext\";\r\n\r\n// top of SearchParams function body\r\nconst [theme, setTheme] = useContext(ThemeContext);\r\n```\r\n\r\nTo consume inside class component\r\n\r\n```jsx\r\n// import\r\nimport ThemeContext from \"./ThemeContext\";\r\n\r\n// replace button\r\n<ThemeContext.Consumer>\r\n  {([theme]) => (\r\n    <button style={{ backgroundColor: theme }}>Adopt {name}</button>\r\n  )}\r\n</ThemeContext.Consumer>\r\n```\r\n\r\nTo change the theme in the context, use `setTheme`.\r\n\r\n\r\n### Portals and `useRef`\r\n\r\nSeparate mount point. Can be used to make a modal or contextual navbar.\r\n\r\n```jsx\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\n\r\nconst Modal = ({ children }) => {\r\n  const elRef = useRef(null);\r\n  if (!elRef.current) {\r\n    elRef.current = document.createElement(\"div\");\r\n  }\r\n\r\n  useEffect(() => {\r\n    const modalRoot = document.getElementById(\"modal\");\r\n    modalRoot.appendChild(elRef.current);\r\n    return () => modalRoot.removeChild(elRef.current);\r\n  }, []);\r\n\r\n  return createPortal(<div>{children}</div>, elRef.current);\r\n}\r\n...\r\n```\r\n\r\nThis will mount the component when rendered and then remove it when unrendered.\r\n\r\nRefs are instance variable for function components. Anytime refer to `elRef.current`, it will always referring to the same element, while `useState` will always refer to the state of variable when the function is called."},{"title":"Build a Modern User Interface with Chakra UI - Notes","excerpt":"A simple study note written as I take \"Build a Modern User Interface with Chakra UI\" course in egghead.io","date":"2020-08-05","slug":"build-a-modern-user-interface-with-chakra-ui-notes","content":"\r\nThis is the note I take as I watch this course \r\n[Build a Modern User Interface with Chakra UI - egghead.io](https://egghead.io/lessons/react-install-and-setup-chakra-ui-in-a-react-project)\r\n\r\nFor more information about Chakra UI, check out the [Chakra UI documentation](https://chakra-ui.com/docs).\r\n\r\n## Install and Setup Chakra UI in a React Project\r\n\r\nAdd dependencies to project.\r\n\r\n```sh\r\nnpm i @chakra-ui/react @emotion/react @emotion/styled framer-motion\r\n\r\n## or\r\n\r\nyarn add @chakra-ui/react @emotion/react @emotion/styled framer-motion\r\n```\r\n\r\nWrap the outer app in a `<ChakraProvider>` component.\r\n\r\n```jsx\r\nconst App = () => {\r\n  return (\r\n\t<ChakraProvider>\r\n\t  ...\r\n\t</ChakraProvider>\r\n  );\r\n}\r\n```\r\n\r\n## Build a Layout with the Container, Flex and VStack Component in Chakra UI\r\n\r\nImport the component\r\n\r\n```jsx\r\nimport { Container, Flex, VStack } from '@chakra-ui/react';\r\n```\r\n\r\nUse the component in jsx\r\n\r\n```jsx\r\nconst IndexPage = () => (\r\n\t<Container>\r\n\t\t...\r\n\t</Container>\r\n)\r\n```\r\n\r\nWe can also style the Chakra UI components with style props. In the background, the style props are converted into CSS rules.\r\n\r\nSome props also has custom values from Chakra that we can use e.g. `maxW=\"container.xl\"` or `h={5}`. \r\n\r\nSome props also has it's own shorthands like `maxW` instead of `maxWidth` and `h`/`w` instead of `height`/`width`.\r\n\r\nChakra also has `Stack` component, it has support to set spacing between elements, it has two derivatives, `HStack` and `VStack`.\r\n\r\n## Build a 2-Column Form with the SimpleGrid, FormControl, and Input Component in Chakra UI\r\n\r\nChakra has `SimpleGrid` component.\r\n\r\n```jsx\r\nimport { SimpleGrid } from '@chakra-ui/react';\r\n```\r\n\r\n`SimpleGrid` is a grid component that can be used to create a grid of elements. We can set the number of columns and the spacing between them.\r\n\r\n```jsx\r\n...\r\n\t<SimpleGrid columns={2} columnGap={3} rowGap={2} rows={3}>\r\n\t\t...\r\n\t</SimpleGrid>\r\n...\r\n```\r\n\r\n`GridItem` is a component that can be used to create a grid item inside the `SimpleGrid`. By setting the colSpan and rowSpan props, we can set the number of columns and rows that the item will take.\r\n\r\n```jsx\r\nimport { GridItem } from '@chakra-ui/react';\r\n\r\n...\r\n<GridItem colSpan={1}>\r\n\t...\r\n</GridItem>\r\n...\r\n```\r\n\r\nCreating Form in Chakra UI has several inputs. We can use them to create a form. Several of them are `Input`, `Select`, and `Checkbox`. We can wrap them inside `FormControl` component. Inside `FormControl`, We can use `FormLabel` to create a label for the input.\r\n\r\n## Create a Dark Mode Switcher in Chakra UI\r\n\r\nChakra UI has `useColorMode` and `useColorModeValue` React hook. It could be used to create a dark mode switcher.\r\nWe can use it with `onClick` props in button.\r\n\r\n```jsx\r\nimport { useColorMode, useColorModeValue } from '@chakra-ui/react';\r\n\r\n\t...\r\n\tconst { toggleColorMode } = useColorMode();\r\n\tconst bgColor = useColorModeValue('gray.50', 'whiteAlpha.50');\r\n\t...\r\n\t<VStack\r\n\t\tbg={bgColor}\r\n\t>\r\n\t\t<Button onClick={toggleColorMode}>\r\n\t\t\t\r\n\t\t</Button>\r\n\t</VStack>\r\n\t...\r\n```\r\n\r\n`useColorModeValue` used to decide the color on dark and light mode, with the first argument being the light mode color and the second argument being the dark mode color.\r\n\r\n## Implement Responsive Design in Chakra UI\r\n\r\nThere are few ways to implement responsive design in Chakra UI. \r\n\r\n1. Responsive array syntax.\r\n\r\n\t```jsx\r\n\tpy={[0, 10, 20]}\r\n\t```\r\n\r\n2. Responsive object syntax.\r\n\r\n\t```jsx\r\n\tdirection = {{ base: 'column-reverse', md: 'row' }}\r\n\t```\r\n\r\n3. Use `useBreakpointValue`.\r\n\r\n\t```jsx\r\n\timport { useBreakpointValue } from '@chakra-ui/react';\r\n\r\n\t...\r\n\tconst colSpan = useBreakpointValue({ base: 2, md: 1 });\r\n\t<GridItem colSpan={colSpan}>\r\n\t\t...\r\n\t</GridItem>\r\n\t...\r\n\r\n\t```\r\n\r\n## Define Custom Colors and Fonts in Chakra UI\r\n\r\nWe could define custom themes by make a separate file and import `extendTheme()` method.\r\n\r\n```jsx\r\nimport { extendTheme } from '@chakra-ui/react';\r\n\r\n\r\nconst theme = extendTheme({\r\n\t...\r\n});\r\n```\r\n\r\nand use it in the `<ChakraProvider>` component.\r\n\r\n```jsx\r\n<ChakraProvider theme={theme}>\r\n...\r\n</ChakraProvider>\r\n```\r\n\r\nWe can also provide fallback value to the theme.\r\n\r\n```jsx\r\nimport { extendTheme } from '@chakra-ui/react';\r\n\r\nconst theme = extendTheme({\r\n\tfonts: {\r\n\t\theading: `..., ${base.fonts?.heading}`,\r\n\t\tbody: `..., ${base.fonts?.body}`,\r\n\t},\r\n\tcolors: {\r\n\t\t...\r\n\t}\r\n});\r\n```\r\n\r\n## Use Theme Extensions in Chakra UI\r\n\r\nBy using theme extension, we can extend the theme.\r\n\r\nOne of the theme extension is `withDefaultColorScheme` and use it inside `extendTheme()`.\r\n\r\n```jsx\r\nimport { ..., withDefaultColorScheme } from '@chakra-ui/react';\r\n\r\nconst theme = extendTheme(\r\n\t{\r\n\t\t...\r\n\t},\r\n\twithDefaultColorScheme({\r\n\t\tcolorScheme: 'brand',\r\n\t\tcomponents: ['Checkbox', ...],\r\n\t})\r\n);\r\n```\r\n\r\nWe can also use another theme extensions like `withDefaultVariant`, etc.\r\n\r\nBy using theme extension, we can set custom style without manually set style to each components.\r\n\r\n## Override the Built-in Component's Styles in Chakra UI\r\n\r\nWe can override component props inside `extendTheme`.\r\n\r\n```jsx\r\nconst theme = extendTheme({\r\n\t...,\r\n\tcomponents: {\r\n\t\tInput: {\r\n\t\t\tvariants: {\r\n\t\t\t\tfilled: {\r\n\t\t\t\t\tfield: {\r\n\t\t\t\t\t\t_focus: {\r\n\t\t\t\t\t\t\tboderColor: 'brand.500'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsizes: {\r\n\t\t\t\tmd: {\r\n\t\t\t\t\tfield: {\r\n\t\t\t\t\t\tborderRadius: 'none'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n})\r\n```\r\n\r\nWe could also separate the style of the component into a separate variable.\r\n\r\n```jsx\r\nconst inputSelectStyles: {\r\n\t...\r\n}\r\n\r\nconst theme = extendTheme({\r\n\t...\r\n\tcomponents: {\r\n\t\tInput: { ...inputSelectStyles },\r\n\t\t...\r\n\t}\r\n})\r\n```\r\n\r\n## Create Custom Variants in Chakra UI\r\n\r\n\r\nWe can add custom variants like we override component props.\r\n\r\n```jsx\r\nconst theme = extendTheme({\r\n\t...\r\n\tcomponents: {\r\n\t\tInput: {\r\n\t\t\tvariants: {\r\n\t\t\t\tcustom: {\r\n\t\t\t\t\tborder: none\r\n\t\t\t\t},\r\n\t\t\t\t...\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n})\r\n```\r\n\r\nWe can set light mode and dark mode color for the custom variant.\r\n\r\n```jsx\r\nconst theme = extendTheme({\r\n\t...\r\n\tcomponents: {\r\n\t\tInput: {\r\n\t\t\tvariants: {\r\n\t\t\t\tprimary: (props) => ({\r\n\t\t\t\t\tbackgroundColor: mode('gray.100', 'whiteAlpha.100')(props),\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n})\r\n```\r\n\r\n```jsx\r\nconst theme = extendTheme({\r\n\t...\r\n\tcomponents: {\r\n\t\tInput: {\r\n\t\t\tvariants: {\r\n\t\t\t\tcustom: {\r\n\t\t\t\t\tcolor: 'gray.500',\r\n\t\t\t\t\tcolorMode: 'dark'\r\n\t\t\t\t},\r\n\t\t\t\t...\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n})\r\n```"}]},"__N_SSG":true}